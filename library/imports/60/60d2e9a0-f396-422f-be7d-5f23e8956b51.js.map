{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\game.js"],"names":["cc","Class","extends","Component","properties","circle","default","type","Node","itemTemplate","broadcast","curRotate","setp","curSpeed","timer1","mysScheduler","listScript","onLoad","log","recarbg","find","node","getComponent","broadcastNode","broadcastScript","start","circleRun","speed","cirecleNode","stopAllActions","rotate","rotateBy","callback","callFunc","updateRotate","seq","sequence","runAction","repeatForever","createItem","tilp","num","id","item","instantiate","x","y","updateItem","cirecleStopToSetp","are","rotation","Math","abs","resetTimer1","_youGetNum","pushToList","baradcastMsg","target","data","startRandom","floor","rand","startTimer1","time","unschedule","sch1s","schedule","dt","update"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        circle:{\n            default:null,\n            type:cc.Node,\n        },\n        itemTemplate:{\n            default:null,\n            type:cc.Node, \n        },\n        broadcast:{\n            default:null,\n            type:cc.Node,\n        },\n        curRotate: 0,\n        setp: 51.4,\n        curSpeed: 0,\n        timer1 : 0,\n        mysScheduler : null,\n        listScript : null,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n     onLoad () {\n        cc.log(\"--------- game start -----------\");\n        var recarbg = cc.find(\"main/recarbg\",this.node); \n        this.listScript = recarbg.getComponent(\"ListViewCtrl\");\n        var broadcastNode = cc.find(\"main/boradbg\",this.node);\n        this.broadcastScript = broadcastNode.getComponent(\"broadcast\")\n         },\n\n    start () {\n\n    },\n \n    circleRun (speed) {\n       if(!this.circle){ \n        cc.log(\"circle is null\");\n        return;\n        }\n        if (speed < 0 ){speed = 0}\n        if(speed == this.setp){return ;}\n        // cc.log(\"---------- circlerun -----------\")\n        speed = speed || 50;\n        this.speed = speed;\n        var cirecleNode = this.circle;\n        cirecleNode.stopAllActions();\n        var rotate = cc.rotateBy(this.setp/speed,-this.setp);\n        var callback = cc.callFunc(this.updateRotate, this);\n\n        var seq = cc.sequence(rotate,callback);\n        cirecleNode.runAction(cc.repeatForever(seq));\n        return;\n    },\n\n    createItem (tilp, num, id){\n        var item = cc.instantiate(this.itemTemplate)\n        item.x = 0\n        item.y = 0\n        item.getComponent(\"item\").updateItem(tilp,num,0)\n        return item\n    },\n\n    cirecleStopToSetp (setp) {\n        var rotate = (setp - 1) * this.setp % 360;\n        var are = 51;\n        var curRotate = -this.circle.rotation % 360\n        // cc.log(\"curRotate = %s, rotate = %s\",curRotate, rotate)\n        if (Math.abs(curRotate - rotate) <= 3 )\n        {\n            var cirecleNode = this.circle;\n            cirecleNode.stopAllActions();\n            this.resetTimer1();\n            var item = this.createItem(\"一切随缘\",this._youGetNum,0)\n            this.listScript.pushToList(item)\n            this.broadcastScript.baradcastMsg(\"谢谢你的成全\")\n            cc.log(\"-------- stoped all -------\")\n        }\n    },\n\n    updateRotate (target,data){\n        this.curRotate = (this.curRotate + this.setp) % 360\n        // cc.log(\"curRotate = %s, setp = %s\", this.curRotate, this.setp)\n    },\n\n    startRandom () {\n        this.broadcastScript.baradcastMsg(\"有时间绝望，不如去吃肉\")\n        this._youGetNum  = Math.floor((cc.rand() % 6) + 1);\n        cc.log(\"you get num = %d\", this._youGetNum)\n        this.startTimer1()\n    },\n\n    startTimer1(time){\n        this.timer1 = time || 0;\n        this.unschedule(this.sch1s);\n        this.schedule(this.sch1s,1);\n        cc.log(\"----------- startTimer1 ----------\");\n    },\n\n    resetTimer1(time){\n        this.timer1 = time || 0;\n        this.unschedule(this.sch1s);\n        cc.log(\"-------- resetTimer1 ---------\");\n    },\n\n    sch1s (dt){\n        this.timer1 = this.timer1 + 1;\n        // cc.log(\"timer1 time = %s,speed = %d\", this.timer1, this.speed);\n        if (this.timer1 >= 4)\n        {\n            // cc.log(\"--------speed -- --------\")\n            this.circleRun(this.speed - this.timer1*10);\n        }\n        else\n        {\n            // cc.log(\"--------speed ++ --------\")\n            this.circleRun(this.timer1*5 * this.setp);\n        }\n    },\n    update (dt) {\n        if(this.timer1 <= 0){return;}\n        if (this.timer1 >= 4)\n        {\n            if ((this.speed - this.setp) <= 1)\n            {\n                // cc.log(\"------------ will be stop ---------\");\n                this.cirecleStopToSetp(this._youGetNum);\n            }\n        }\n    },\n});\n"]}
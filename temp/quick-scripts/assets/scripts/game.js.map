{"version":3,"sources":["game.js"],"names":["cc","Class","extends","Component","properties","circle","default","type","Node","itemTemplate","broadcast","curRotate","setp","curSpeed","timer1","mysScheduler","listScript","msgList","onLoad","log","recarbg","find","node","getComponent","broadcastNode","broadcastScript","start","circleRun","speed","cirecleNode","stopAllActions","rotate","rotateBy","callback","callFunc","updateRotate","seq","sequence","runAction","repeatForever","createItem","tilp","num","id","item","instantiate","x","y","updateItem","cirecleStopToSetp","are","rotation","Math","abs","resetTimer1","itemStr","hisList","_youGetNum","length","pushToList","bIndex","random","tilpList","baradcastMsg","target","data","startRandom","startTimer1","time","unschedule","sch1s","schedule","dt","update","begin","end","floor"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        circle:{\n            default:null,\n            type:cc.Node,\n        },\n        itemTemplate:{\n            default:null,\n            type:cc.Node, \n        },\n        broadcast:{\n            default:null,\n            type:cc.Node,\n        },\n        curRotate: 0,\n        setp: 51.4,\n        curSpeed: 0,\n        timer1 : 0,\n        mysScheduler : null,\n        listScript : null,\n        msgList : null,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n     onLoad () {\n        cc.log(\"--------- game start -----------\");\n        var recarbg = cc.find(\"main/recarbg\",this.node); \n        this.listScript = recarbg.getComponent(\"ListViewCtrl\");\n        var broadcastNode = cc.find(\"main/boradbg\",this.node);\n        this.broadcastScript = broadcastNode.getComponent(\"broadcast\");\n        this.msgList = this.getComponent(\"msgList\");\n         },\n\n    start () {\n\n    },\n \n    circleRun (speed) {\n       if(!this.circle){ \n        cc.log(\"circle is null\");\n        return;\n        }\n        if (speed < 0 ){speed = 0}\n        if(speed == this.setp){return ;}\n        // cc.log(\"---------- circlerun -----------\")\n        speed = speed || 50;\n        this.speed = speed;\n        var cirecleNode = this.circle;\n        cirecleNode.stopAllActions();\n        var rotate = cc.rotateBy(this.setp/speed,-this.setp);\n        var callback = cc.callFunc(this.updateRotate, this);\n\n        var seq = cc.sequence(rotate,callback);\n        cirecleNode.runAction(cc.repeatForever(seq));\n        return;\n    },\n\n    createItem (tilp, num, id){\n        var item = cc.instantiate(this.itemTemplate)\n        item.x = 0\n        item.y = 0\n        item.getComponent(\"item\").updateItem(tilp,num,0)\n        return item\n    },\n\n    cirecleStopToSetp (setp) {\n        var rotate = (setp - 1) * this.setp % 360;\n        var are = 51;\n        var curRotate = -this.circle.rotation % 360\n        // cc.log(\"curRotate = %s, rotate = %s\",curRotate, rotate)\n        if (Math.abs(curRotate - rotate) <= 3 )\n        {\n            var cirecleNode = this.circle;\n            cirecleNode.stopAllActions();\n            this.resetTimer1();\n            var itemStr = this.msgList.hisList[this._youGetNum - 1 % this.msgList.hisList.length];\n            var item = this.createItem(itemStr,this._youGetNum,0);\n            this.listScript.pushToList(item);\n            var bIndex  = this.random(0,this.msgList.tilpList.length)\n            this.broadcastScript.baradcastMsg(this.msgList.tilpList[bIndex])\n            cc.log(\"-------- stoped all -------\")\n        }\n    },\n\n    updateRotate (target,data){\n        this.curRotate = (this.curRotate + this.setp) % 360\n        // cc.log(\"curRotate = %s, setp = %s\", this.curRotate, this.setp)\n    },\n\n    startRandom () {\n        var bIndex  = this.random(0,this.msgList.tilpList.length)\n        this.broadcastScript.baradcastMsg(this.msgList.tilpList[bIndex])\n        this._youGetNum  = this.random(1,7)\n        cc.log(\"you get num = %d\", this._youGetNum)\n        this.startTimer1()\n    },\n\n    startTimer1(time){\n        this.timer1 = time || 0;\n        this.unschedule(this.sch1s);\n        this.schedule(this.sch1s,1);\n        cc.log(\"----------- startTimer1 ----------\");\n    },\n\n    resetTimer1(time){\n        this.timer1 = time || 0;\n        this.unschedule(this.sch1s);\n        cc.log(\"-------- resetTimer1 ---------\");\n    },\n\n    sch1s (dt){\n        this.timer1 = this.timer1 + 1;\n        // cc.log(\"timer1 time = %s,speed = %d\", this.timer1, this.speed);\n        if (this.timer1 >= 4)\n        {\n            // cc.log(\"--------speed -- --------\")\n            this.circleRun(this.speed - this.timer1*10);\n        }\n        else\n        {\n            // cc.log(\"--------speed ++ --------\")\n            this.circleRun(this.timer1*5 * this.setp);\n        }\n    },\n    update (dt) {\n        if(this.timer1 <= 0){return;}\n        if (this.timer1 >= 4)\n        {\n            if ((this.speed - this.setp) <= 1)\n            {\n                // cc.log(\"------------ will be stop ---------\");\n                this.cirecleStopToSetp(this._youGetNum);\n            }\n        }\n    },\n    random (begin, end)\n    {\n       return Math.floor(Math.random()*(end - begin) + begin) ;\n    },\n});\n"]}
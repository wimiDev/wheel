{"version":3,"sources":["gameStorage.js"],"names":["cc","Class","extends","Component","properties","coinKey","hisKey","hisIndex","defaultCoin","onLoad","hisMAX","init","start","myCoin","getMyCoin","log","getHisIndex","sys","localStorage","getItem","setMyCoin","val","setItem","setHisIndex","getHisByIndex","idx","_hisKey","hisObj","JSON","parse","setHisByIndex","data","stringify","getAllHis","allHis","Array","i","push","addAHis","_time","_item","time","item","Number","getCurTime","date","Date","mon","getMonth","day","getDate","hour","getHours","min","getMinutes","sec","getSeconds","timeStr","join"],"mappings":"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","file":"gameStorage.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\tool","sourcesContent":["\r\n//金币默认开始是88\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        coinKey : \"COIN\",\r\n        hisKey : \"RANDHIS_\",\r\n        hisIndex : \"HISINDEX\",\r\n        defaultCoin : 520,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.hisMAX = 10;\r\n        this.init();\r\n    },\r\n\r\n    start () {\r\n        \r\n    },\r\n    init()\r\n    {\r\n        //init mycoin\r\n        var myCoin =  this.getMyCoin();\r\n        cc.log(\"myCoin = %s\",this.getMyCoin());\r\n\r\n        //init hisIndex\r\n        var hisIndex = this.getHisIndex();\r\n        cc.log(\"hisIndex = %s\", this.getHisIndex())\r\n    },\r\n\r\n    getMyCoin ()\r\n    {\r\n        return cc.sys.localStorage.getItem(this.coinKey) || this.defaultCoin;\r\n    },\r\n\r\n    setMyCoin(val)\r\n    {\r\n        cc.sys.localStorage.setItem(this.coinKey,val)\r\n    },\r\n\r\n    getHisIndex()\r\n    {\r\n        return cc.sys.localStorage.getItem(this.hisIndex) || 0;\r\n    },\r\n    \r\n    setHisIndex(val)\r\n    {\r\n        cc.sys.localStorage.setItem(this.hisIndex,val);\r\n    },\r\n\r\n    getHisByIndex(idx)\r\n    {\r\n        var _hisKey = \"\"; \r\n        _hisKey = this.hisKey + idx;\r\n        cc.log(\"get his idx = %s, data = %s\", _hisKey, cc.sys.localStorage.getItem(_hisKey));\r\n        var hisObj = JSON.parse(cc.sys.localStorage.getItem(_hisKey));\r\n        return hisObj;\r\n    },\r\n\r\n    setHisByIndex(idx,data)\r\n    {\r\n        var _hisKey =  this.hisKey + idx;\r\n        cc.log(\"hisKey = %s, storage key = %s\",_hisKey, JSON.stringify(data));\r\n        cc.sys.localStorage.setItem(_hisKey, JSON.stringify(data));\r\n    },\r\n\r\n    getAllHis()\r\n    {\r\n        var allHis = new Array();\r\n        for(var i = 1; i <= 10; ++i){\r\n            var hisObj = this.getHisByIndex(i);\r\n            allHis.push(hisObj);\r\n        }\r\n        return allHis;\r\n    },\r\n\r\n    addAHis(_time,_item)\r\n    {\r\n        var data = {\r\n            time : _time,\r\n            item : _item,\r\n        };\r\n        var hisIndex = Number(this.getHisIndex());\r\n\r\n        if(hisIndex < 1){\r\n            hisIndex = 1;\r\n        } \r\n        else{\r\n            hisIndex = hisIndex + 1;\r\n        }\r\n       \r\n        if(hisIndex > this.hisMAX){\r\n            hisIndex = 1;\r\n        } \r\n        cc.log(\"addAHis -> %s\",hisIndex)\r\n        this.setHisByIndex(hisIndex,data);\r\n        this.setHisIndex(hisIndex);\r\n    },\r\n\r\n    getCurTime(){\r\n        var date = new Date();\r\n        var mon = date.getMonth() + 1;\r\n        var day = date.getDate();\r\n        var hour = date.getHours();\r\n        var min = date.getMinutes();\r\n        var sec = date.getSeconds();\r\n        var timeStr = [mon,day].join(\"/\") + \"   \" + [hour,min,sec].join(\":\");\r\n        cc.log(\"getCurTime %s\",timeStr)\r\n        return timeStr\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}